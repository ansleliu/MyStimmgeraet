;-----------------------------------------------------------------------------;
; Fixed-point FFT routines for megaAVRs                        (C)ChaN, 2005
;-----------------------------------------------------------------------------;
;
; void fft_input (const int16_t *array_src, complex_t *array_bfly);
; void fft_execute (complex_t *array_bfly);
; void fft_output (complex_t *array_bfly, uint16_t *array_dst);
;
;  <array_src>: Wave form to be processed.
;  <array_bfly>: Complex array for butterfly operations.
;  <array_dst>: Spectrum output buffer.
;
; These functions must be called in sequence to do a DFT in FFT algorithm.
; fft_input() fills the complex array with a wave form to prepare butterfly
; operations. A hamming window is applied at the same time.
; fft_execute() executes the butterfly operations.
; fft_output() re-orders the results, converts the complex spectrum into
; scalar spectrum and output it in linear scale.
;
; The number of points FFT_N is defined in "ffft.h" and the value can be 64,
; 128, 256 or 512.
;
;----------------------------------------------------------------------------;
; 16bit fixed-point FFT performance with a MegaAVR @16MHz (measured)
;
;  Points:   Input, Execute,  Output,    Total:  Throughput
;   64pts:   .17ms,   2.0ms,   1.2ms,    3.4ms:   19.0kpps
;  128pts:   .33ms,   4.6ms,   2.4ms,    7.3ms:   17.5kpps
;  256pts:   .66ms,  10.4ms,   4.9ms,   15.9ms:   16.1kpps
;  512pts:   1.3ms,  23.2ms,   9.7ms,   34.2ms:   14.9kpps
; 1024pts:   <undefined>
;----------------------------------------------------------------------------;


.nolist
#define FFFT_ASM
#include "fft.h"
.list
#if FFT_N == 2048
#define FFT_B 11
#elif FFT_N == 512
#define FFT_B 9
#elif FFT_N == 256
#define FFT_B 8
#elif FFT_N == 128
#define FFT_B 7
#elif FFT_N == 64
#define FFT_B 6
#else
#error FFT_N must be 64,128,256,512 or 2048.
#endif


;----------------------------------------------------------------------------;
; Constant Tables

.global tbl_window
tbl_window:	; tbl_window[] = ... (This is a Hamming window)
#if FFT_N == 2048
	.dc.w	2621, 2621, 2622, 2622, 2622, 2623, 2624, 2625, 2626, 2627, 2628, 2630, 2632, 2633, 2635, 2637
	.dc.w	2640, 2642, 2644, 2647, 2650, 2653, 2656, 2659, 2662, 2666, 2669, 2673, 2677, 2681, 2685, 2689
	.dc.w	2694, 2699, 2703, 2708, 2713, 2718, 2724, 2729, 2735, 2740, 2746, 2752, 2758, 2765, 2771, 2778
	.dc.w	2785, 2791, 2798, 2805, 2813, 2820, 2828, 2835, 2843, 2851, 2859, 2868, 2876, 2885, 2893, 2902
	.dc.w	2911, 2920, 2929, 2939, 2948, 2958, 2968, 2978, 2988, 2998, 3008, 3019, 3029, 3040, 3051, 3062
	.dc.w	3073, 3084, 3096, 3107, 3119, 3131, 3143, 3155, 3167, 3180, 3192, 3205, 3218, 3231, 3244, 3257
	.dc.w	3270, 3284, 3298, 3311, 3325, 3339, 3353, 3368, 3382, 3397, 3411, 3426, 3441, 3456, 3472, 3487
	.dc.w	3502, 3518, 3534, 3550, 3566, 3582, 3598, 3615, 3631, 3648, 3665, 3682, 3699, 3716, 3734, 3751
	.dc.w	3769, 3786, 3804, 3822, 3841, 3859, 3877, 3896, 3914, 3933, 3952, 3971, 3990, 4010, 4029, 4049
	.dc.w	4069, 4088, 4108, 4128, 4149, 4169, 4189, 4210, 4231, 4252, 4273, 4294, 4315, 4336, 4358, 4379
	.dc.w	4401, 4423, 4445, 4467, 4489, 4512, 4534, 4557, 4580, 4602, 4625, 4648, 4672, 4695, 4718, 4742
	.dc.w	4766, 4790, 4814, 4838, 4862, 4886, 4911, 4935, 4960, 4985, 5010, 5035, 5060, 5085, 5110, 5136
	.dc.w	5162, 5187, 5213, 5239, 5265, 5292, 5318, 5344, 5371, 5398, 5424, 5451, 5478, 5505, 5533, 5560
	.dc.w	5588, 5615, 5643, 5671, 5699, 5727, 5755, 5783, 5812, 5840, 5869, 5897, 5926, 5955, 5984, 6013
	.dc.w	6043, 6072, 6102, 6131, 6161, 6191, 6221, 6251, 6281, 6311, 6342, 6372, 6403, 6433, 6464, 6495
	.dc.w	6526, 6557, 6588, 6620, 6651, 6683, 6714, 6746, 6778, 6810, 6842, 6874, 6906, 6938, 6971, 7003
	.dc.w	7036, 7069, 7102, 7135, 7168, 7201, 7234, 7267, 7301, 7334, 7368, 7402, 7436, 7470, 7504, 7538
	.dc.w	7572, 7606, 7641, 7675, 7710, 7744, 7779, 7814, 7849, 7884, 7919, 7954, 7990, 8025, 8061, 8096
	.dc.w	8132, 8168, 8204, 8240, 8276, 8312, 8348, 8384, 8421, 8457, 8494, 8531, 8567, 8604, 8641, 8678
	.dc.w	8715, 8752, 8790, 8827, 8865, 8902, 8940, 8977, 9015, 9053, 9091, 9129, 9167, 9205, 9243, 9282
	.dc.w	9320, 9359, 9397, 9436, 9475, 9513, 9552, 9591, 9630, 9669, 9709, 9748, 9787, 9827, 9866, 9906
	.dc.w	9945, 9985, 10025, 10065, 10104, 10144, 10184, 10225, 10265, 10305, 10345, 10386, 10426, 10467, 10507, 10548
	.dc.w	10589, 10630, 10671, 10712, 10753, 10794, 10835, 10876, 10917, 10959, 11000, 11041, 11083, 11125, 11166, 11208
	.dc.w	11250, 11292, 11333, 11375, 11417, 11459, 11502, 11544, 11586, 11628, 11671, 11713, 11756, 11798, 11841, 11883
	.dc.w	11926, 11969, 12012, 12054, 12097, 12140, 12183, 12226, 12270, 12313, 12356, 12399, 12443, 12486, 12529, 12573
	.dc.w	12616, 12660, 12703, 12747, 12791, 12835, 12878, 12922, 12966, 13010, 13054, 13098, 13142, 13186, 13230, 13275
	.dc.w	13319, 13363, 13407, 13452, 13496, 13541, 13585, 13630, 13674, 13719, 13763, 13808, 13853, 13897, 13942, 13987
	.dc.w	14032, 14077, 14122, 14167, 14211, 14256, 14302, 14347, 14392, 14437, 14482, 14527, 14572, 14618, 14663, 14708
	.dc.w	14754, 14799, 14844, 14890, 14935, 14981, 15026, 15072, 15117, 15163, 15208, 15254, 15300, 15345, 15391, 15437
	.dc.w	15483, 15528, 15574, 15620, 15666, 15712, 15757, 15803, 15849, 15895, 15941, 15987, 16033, 16079, 16125, 16171
	.dc.w	16217, 16263, 16309, 16355, 16401, 16447, 16493, 16539, 16585, 16631, 16678, 16724, 16770, 16816, 16862, 16908
	.dc.w	16955, 17001, 17047, 17093, 17139, 17186, 17232, 17278, 17324, 17371, 17417, 17463, 17509, 17555, 17602, 17648
	.dc.w	17694, 17740, 17787, 17833, 17879, 17925, 17972, 18018, 18064, 18110, 18157, 18203, 18249, 18295, 18341, 18388
	.dc.w	18434, 18480, 18526, 18572, 18618, 18665, 18711, 18757, 18803, 18849, 18895, 18941, 18987, 19033, 19080, 19126
	.dc.w	19172, 19218, 19264, 19310, 19356, 19401, 19447, 19493, 19539, 19585, 19631, 19677, 19723, 19769, 19814, 19860
	.dc.w	19906, 19952, 19997, 20043, 20089, 20134, 20180, 20225, 20271, 20317, 20362, 20408, 20453, 20499, 20544, 20589
	.dc.w	20635, 20680, 20725, 20771, 20816, 20861, 20906, 20952, 20997, 21042, 21087, 21132, 21177, 21222, 21267, 21312
	.dc.w	21357, 21401, 21446, 21491, 21536, 21580, 21625, 21670, 21714, 21759, 21803, 21848, 21892, 21937, 21981, 22025
	.dc.w	22070, 22114, 22158, 22202, 22246, 22290, 22334, 22378, 22422, 22466, 22510, 22554, 22598, 22641, 22685, 22728
	.dc.w	22772, 22816, 22859, 22902, 22946, 22989, 23032, 23076, 23119, 23162, 23205, 23248, 23291, 23334, 23377, 23420
	.dc.w	23462, 23505, 23548, 23590, 23633, 23675, 23718, 23760, 23802, 23845, 23887, 23929, 23971, 24013, 24055, 24097
	.dc.w	24139, 24180, 24222, 24264, 24305, 24347, 24388, 24430, 24471, 24512, 24554, 24595, 24636, 24677, 24718, 24759
	.dc.w	24799, 24840, 24881, 24922, 24962, 25003, 25043, 25083, 25124, 25164, 25204, 25244, 25284, 25324, 25364, 25403
	.dc.w	25443, 25483, 25522, 25562, 25601, 25641, 25680, 25719, 25758, 25797, 25836, 25875, 25914, 25952, 25991, 26030
	.dc.w	26068, 26107, 26145, 26183, 26221, 26259, 26297, 26335, 26373, 26411, 26449, 26486, 26524, 26561, 26599, 26636
	.dc.w	26673, 26710, 26747, 26784, 26821, 26858, 26894, 26931, 26967, 27004, 27040, 27076, 27113, 27149, 27185, 27220
	.dc.w	27256, 27292, 27328, 27363, 27399, 27434, 27469, 27504, 27539, 27574, 27609, 27644, 27679, 27713, 27748, 27782
	.dc.w	27816, 27851, 27885, 27919, 27953, 27987, 28020, 28054, 28088, 28121, 28154, 28188, 28221, 28254, 28287, 28320
	.dc.w	28352, 28385, 28417, 28450, 28482, 28515, 28547, 28579, 28611, 28642, 28674, 28706, 28737, 28769, 28800, 28831
	.dc.w	28862, 28893, 28924, 28955, 28986, 29016, 29047, 29077, 29107, 29138, 29168, 29198, 29227, 29257, 29287, 29316
	.dc.w	29346, 29375, 29404, 29433, 29462, 29491, 29520, 29548, 29577, 29605, 29633, 29662, 29690, 29718, 29745, 29773
	.dc.w	29801, 29828, 29856, 29883, 29910, 29937, 29964, 29991, 30017, 30044, 30071, 30097, 30123, 30149, 30175, 30201
	.dc.w	30227, 30252, 30278, 30303, 30329, 30354, 30379, 30404, 30429, 30453, 30478, 30502, 30527, 30551, 30575, 30599
	.dc.w	30623, 30646, 30670, 30693, 30717, 30740, 30763, 30786, 30809, 30832, 30854, 30877, 30899, 30921, 30943, 30965
	.dc.w	30987, 31009, 31031, 31052, 31073, 31095, 31116, 31137, 31158, 31178, 31199, 31219, 31240, 31260, 31280, 31300
	.dc.w	31320, 31340, 31359, 31379, 31398, 31417, 31436, 31455, 31474, 31493, 31511, 31530, 31548, 31566, 31584, 31602
	.dc.w	31620, 31637, 31655, 31672, 31689, 31706, 31723, 31740, 31757, 31774, 31790, 31806, 31823, 31839, 31854, 31870
	.dc.w	31886, 31901, 31917, 31932, 31947, 31962, 31977, 31992, 32006, 32021, 32035, 32049, 32063, 32077, 32091, 32104
	.dc.w	32118, 32131, 32145, 32158, 32171, 32183, 32196, 32209, 32221, 32233, 32245, 32257, 32269, 32281, 32293, 32304
	.dc.w	32315, 32326, 32337, 32348, 32359, 32370, 32380, 32391, 32401, 32411, 32421, 32431, 32440, 32450, 32459, 32468
	.dc.w	32477, 32486, 32495, 32504, 32512, 32521, 32529, 32537, 32545, 32553, 32561, 32568, 32576, 32583, 32590, 32597
	.dc.w	32604, 32611, 32617, 32624, 32630, 32636, 32642, 32648, 32654, 32659, 32665, 32670, 32675, 32680, 32685, 32690
	.dc.w	32694, 32699, 32703, 32707, 32711, 32715, 32719, 32723, 32726, 32729, 32733, 32736, 32739, 32741, 32744, 32747
	.dc.w	32749, 32751, 32753, 32755, 32757, 32758, 32760, 32761, 32762, 32764, 32764, 32765, 32766, 32766, 32767, 32767
	.dc.w	32767, 32767, 32767, 32766, 32766, 32765, 32764, 32764, 32762, 32761, 32760, 32758, 32757, 32755, 32753, 32751
	.dc.w	32749, 32747, 32744, 32741, 32739, 32736, 32733, 32729, 32726, 32723, 32719, 32715, 32711, 32707, 32703, 32699
	.dc.w	32694, 32690, 32685, 32680, 32675, 32670, 32665, 32659, 32654, 32648, 32642, 32636, 32630, 32624, 32617, 32611
	.dc.w	32604, 32597, 32590, 32583, 32576, 32568, 32561, 32553, 32545, 32537, 32529, 32521, 32512, 32504, 32495, 32486
	.dc.w	32477, 32468, 32459, 32450, 32440, 32431, 32421, 32411, 32401, 32391, 32380, 32370, 32359, 32348, 32337, 32326
	.dc.w	32315, 32304, 32293, 32281, 32269, 32257, 32245, 32233, 32221, 32209, 32196, 32183, 32171, 32158, 32145, 32131
	.dc.w	32118, 32104, 32091, 32077, 32063, 32049, 32035, 32021, 32006, 31992, 31977, 31962, 31947, 31932, 31917, 31901
	.dc.w	31886, 31870, 31854, 31839, 31823, 31806, 31790, 31774, 31757, 31740, 31723, 31706, 31689, 31672, 31655, 31637
	.dc.w	31620, 31602, 31584, 31566, 31548, 31530, 31511, 31493, 31474, 31455, 31436, 31417, 31398, 31379, 31359, 31340
	.dc.w	31320, 31300, 31280, 31260, 31240, 31219, 31199, 31178, 31158, 31137, 31116, 31095, 31073, 31052, 31031, 31009
	.dc.w	30987, 30965, 30943, 30921, 30899, 30877, 30854, 30832, 30809, 30786, 30763, 30740, 30717, 30693, 30670, 30646
	.dc.w	30623, 30599, 30575, 30551, 30527, 30502, 30478, 30453, 30429, 30404, 30379, 30354, 30329, 30303, 30278, 30252
	.dc.w	30227, 30201, 30175, 30149, 30123, 30097, 30071, 30044, 30017, 29991, 29964, 29937, 29910, 29883, 29856, 29828
	.dc.w	29801, 29773, 29745, 29718, 29690, 29662, 29633, 29605, 29577, 29548, 29520, 29491, 29462, 29433, 29404, 29375
	.dc.w	29346, 29316, 29287, 29257, 29227, 29198, 29168, 29138, 29107, 29077, 29047, 29016, 28986, 28955, 28924, 28893
	.dc.w	28862, 28831, 28800, 28769, 28737, 28706, 28674, 28642, 28611, 28579, 28547, 28515, 28482, 28450, 28417, 28385
	.dc.w	28352, 28320, 28287, 28254, 28221, 28188, 28154, 28121, 28088, 28054, 28020, 27987, 27953, 27919, 27885, 27851
	.dc.w	27816, 27782, 27748, 27713, 27679, 27644, 27609, 27574, 27539, 27504, 27469, 27434, 27399, 27363, 27328, 27292
	.dc.w	27256, 27220, 27185, 27149, 27113, 27076, 27040, 27004, 26967, 26931, 26894, 26858, 26821, 26784, 26747, 26710
	.dc.w	26673, 26636, 26599, 26561, 26524, 26486, 26449, 26411, 26373, 26335, 26297, 26259, 26221, 26183, 26145, 26107
	.dc.w	26068, 26030, 25991, 25952, 25914, 25875, 25836, 25797, 25758, 25719, 25680, 25641, 25601, 25562, 25522, 25483
	.dc.w	25443, 25403, 25364, 25324, 25284, 25244, 25204, 25164, 25124, 25083, 25043, 25003, 24962, 24922, 24881, 24840
	.dc.w	24799, 24759, 24718, 24677, 24636, 24595, 24554, 24512, 24471, 24430, 24388, 24347, 24305, 24264, 24222, 24180
	.dc.w	24139, 24097, 24055, 24013, 23971, 23929, 23887, 23845, 23802, 23760, 23718, 23675, 23633, 23590, 23548, 23505
	.dc.w	23462, 23420, 23377, 23334, 23291, 23248, 23205, 23162, 23119, 23076, 23032, 22989, 22946, 22902, 22859, 22816
	.dc.w	22772, 22728, 22685, 22641, 22598, 22554, 22510, 22466, 22422, 22378, 22334, 22290, 22246, 22202, 22158, 22114
	.dc.w	22070, 22025, 21981, 21937, 21892, 21848, 21803, 21759, 21714, 21670, 21625, 21580, 21536, 21491, 21446, 21401
	.dc.w	21357, 21312, 21267, 21222, 21177, 21132, 21087, 21042, 20997, 20952, 20906, 20861, 20816, 20771, 20725, 20680
	.dc.w	20635, 20589, 20544, 20499, 20453, 20408, 20362, 20317, 20271, 20225, 20180, 20134, 20089, 20043, 19997, 19952
	.dc.w	19906, 19860, 19814, 19769, 19723, 19677, 19631, 19585, 19539, 19493, 19447, 19401, 19356, 19310, 19264, 19218
	.dc.w	19172, 19126, 19080, 19033, 18987, 18941, 18895, 18849, 18803, 18757, 18711, 18665, 18618, 18572, 18526, 18480
	.dc.w	18434, 18388, 18341, 18295, 18249, 18203, 18157, 18110, 18064, 18018, 17972, 17925, 17879, 17833, 17787, 17740
	.dc.w	17694, 17648, 17602, 17555, 17509, 17463, 17417, 17371, 17324, 17278, 17232, 17186, 17139, 17093, 17047, 17001
	.dc.w	16955, 16908, 16862, 16816, 16770, 16724, 16678, 16631, 16585, 16539, 16493, 16447, 16401, 16355, 16309, 16263
	.dc.w	16217, 16171, 16125, 16079, 16033, 15987, 15941, 15895, 15849, 15803, 15757, 15712, 15666, 15620, 15574, 15528
	.dc.w	15483, 15437, 15391, 15345, 15300, 15254, 15208, 15163, 15117, 15072, 15026, 14981, 14935, 14890, 14844, 14799
	.dc.w	14754, 14708, 14663, 14618, 14572, 14527, 14482, 14437, 14392, 14347, 14302, 14256, 14211, 14167, 14122, 14077
	.dc.w	14032, 13987, 13942, 13897, 13853, 13808, 13763, 13719, 13674, 13630, 13585, 13541, 13496, 13452, 13407, 13363
	.dc.w	13319, 13275, 13230, 13186, 13142, 13098, 13054, 13010, 12966, 12922, 12878, 12835, 12791, 12747, 12703, 12660
	.dc.w	12616, 12573, 12529, 12486, 12443, 12399, 12356, 12313, 12270, 12226, 12183, 12140, 12097, 12054, 12012, 11969
	.dc.w	11926, 11883, 11841, 11798, 11756, 11713, 11671, 11628, 11586, 11544, 11502, 11459, 11417, 11375, 11333, 11292
	.dc.w	11250, 11208, 11166, 11125, 11083, 11041, 11000, 10959, 10917, 10876, 10835, 10794, 10753, 10712, 10671, 10630
	.dc.w	10589, 10548, 10507, 10467, 10426, 10386, 10345, 10305, 10265, 10225, 10184, 10144, 10104, 10065, 10025, 9985
	.dc.w	9945, 9906, 9866, 9827, 9787, 9748, 9709, 9669, 9630, 9591, 9552, 9513, 9475, 9436, 9397, 9359
	.dc.w	9320, 9282, 9243, 9205, 9167, 9129, 9091, 9053, 9015, 8977, 8940, 8902, 8865, 8827, 8790, 8752
	.dc.w	8715, 8678, 8641, 8604, 8567, 8531, 8494, 8457, 8421, 8384, 8348, 8312, 8276, 8240, 8204, 8168
	.dc.w	8132, 8096, 8061, 8025, 7990, 7954, 7919, 7884, 7849, 7814, 7779, 7744, 7710, 7675, 7641, 7606
	.dc.w	7572, 7538, 7504, 7470, 7436, 7402, 7368, 7334, 7301, 7267, 7234, 7201, 7168, 7135, 7102, 7069
	.dc.w	7036, 7003, 6971, 6938, 6906, 6874, 6842, 6810, 6778, 6746, 6714, 6683, 6651, 6620, 6588, 6557
	.dc.w	6526, 6495, 6464, 6433, 6403, 6372, 6342, 6311, 6281, 6251, 6221, 6191, 6161, 6131, 6102, 6072
	.dc.w	6043, 6013, 5984, 5955, 5926, 5897, 5869, 5840, 5812, 5783, 5755, 5727, 5699, 5671, 5643, 5615
	.dc.w	5588, 5560, 5533, 5505, 5478, 5451, 5424, 5398, 5371, 5344, 5318, 5292, 5265, 5239, 5213, 5187
	.dc.w	5162, 5136, 5110, 5085, 5060, 5035, 5010, 4985, 4960, 4935, 4911, 4886, 4862, 4838, 4814, 4790
	.dc.w	4766, 4742, 4718, 4695, 4672, 4648, 4625, 4602, 4580, 4557, 4534, 4512, 4489, 4467, 4445, 4423
	.dc.w	4401, 4379, 4358, 4336, 4315, 4294, 4273, 4252, 4231, 4210, 4189, 4169, 4149, 4128, 4108, 4088
	.dc.w	4069, 4049, 4029, 4010, 3990, 3971, 3952, 3933, 3914, 3896, 3877, 3859, 3841, 3822, 3804, 3786
	.dc.w	3769, 3751, 3734, 3716, 3699, 3682, 3665, 3648, 3631, 3615, 3598, 3582, 3566, 3550, 3534, 3518
	.dc.w	3502, 3487, 3472, 3456, 3441, 3426, 3411, 3397, 3382, 3368, 3353, 3339, 3325, 3311, 3298, 3284
	.dc.w	3270, 3257, 3244, 3231, 3218, 3205, 3192, 3180, 3167, 3155, 3143, 3131, 3119, 3107, 3096, 3084
	.dc.w	3073, 3062, 3051, 3040, 3029, 3019, 3008, 2998, 2988, 2978, 2968, 2958, 2948, 2939, 2929, 2920
	.dc.w	2911, 2902, 2893, 2885, 2876, 2868, 2859, 2851, 2843, 2835, 2828, 2820, 2813, 2805, 2798, 2791
	.dc.w	2785, 2778, 2771, 2765, 2758, 2752, 2746, 2740, 2735, 2729, 2724, 2718, 2713, 2708, 2703, 2699
	.dc.w	2694, 2689, 2685, 2681, 2677, 2673, 2669, 2666, 2662, 2659, 2656, 2653, 2650, 2647, 2644, 2642
	.dc.w	2640, 2637, 2635, 2633, 2632, 2630, 2628, 2627, 2626, 2625, 2624, 2623, 2622, 2622, 2622, 2621

#elif FFT_N == 512
	.dc.w	2621, 2622, 2625, 2631, 2639, 2649, 2662, 2676, 2693, 2713, 2734, 2758, 2784, 2812, 2843, 2876
	.dc.w	2910, 2948, 2987, 3029, 3073, 3119, 3167, 3217, 3270, 3325, 3382, 3441, 3502, 3565, 3631, 3698
	.dc.w	3768, 3840, 3914, 3990, 4068, 4148, 4230, 4314, 4401, 4489, 4579, 4671, 4765, 4861, 4959, 5059
	.dc.w	5161, 5265, 5370, 5478, 5587, 5698, 5811, 5926, 6042, 6160, 6280, 6402, 6525, 6651, 6777, 6906
	.dc.w	7036, 7167, 7300, 7435, 7571, 7709, 7849, 7989, 8132, 8275, 8420, 8567, 8715, 8864, 9015, 9166
	.dc.w	9320, 9474, 9630, 9787, 9945, 10104, 10264, 10426, 10588, 10752, 10917, 11082, 11249, 11417, 11586, 11755
	.dc.w	11926, 12097, 12269, 12442, 12616, 12790, 12966, 13142, 13318, 13496, 13674, 13852, 14031, 14211, 14391, 14572
	.dc.w	14753, 14935, 15117, 15299, 15482, 15665, 15849, 16032, 16216, 16400, 16585, 16769, 16954, 17139, 17324, 17509
	.dc.w	17694, 17879, 18064, 18248, 18433, 18618, 18802, 18987, 19171, 19355, 19539, 19722, 19905, 20088, 20271, 20453
	.dc.w	20634, 20815, 20996, 21176, 21356, 21535, 21714, 21892, 22069, 22246, 22422, 22597, 22772, 22945, 23118, 23290
	.dc.w	23462, 23632, 23802, 23970, 24138, 24305, 24471, 24635, 24799, 24962, 25123, 25283, 25443, 25601, 25758, 25913
	.dc.w	26068, 26221, 26373, 26523, 26673, 26820, 26967, 27112, 27256, 27398, 27539, 27678, 27816, 27952, 28087, 28220
	.dc.w	28352, 28482, 28610, 28737, 28862, 28985, 29107, 29227, 29345, 29462, 29576, 29689, 29800, 29910, 30017, 30123
	.dc.w	30226, 30328, 30428, 30526, 30622, 30716, 30808, 30899, 30987, 31073, 31157, 31239, 31319, 31397, 31473, 31547
	.dc.w	31619, 31689, 31756, 31822, 31885, 31947, 32006, 32063, 32117, 32170, 32220, 32269, 32315, 32359, 32400, 32440
	.dc.w	32477, 32512, 32545, 32575, 32603, 32629, 32653, 32675, 32694, 32711, 32726, 32738, 32748, 32756, 32762, 32765
	.dc.w	32766, 32765, 32762, 32756, 32748, 32738, 32726, 32711, 32694, 32675, 32653, 32629, 32603, 32575, 32545, 32512
	.dc.w	32477, 32440, 32400, 32359, 32315, 32269, 32221, 32170, 32117, 32063, 32006, 31947, 31885, 31822, 31757, 31689
	.dc.w	31619, 31547, 31473, 31397, 31319, 31239, 31157, 31073, 30987, 30899, 30808, 30716, 30622, 30526, 30428, 30328
	.dc.w	30226, 30123, 30017, 29910, 29800, 29689, 29576, 29462, 29345, 29227, 29107, 28985, 28862, 28737, 28610, 28482
	.dc.w	28352, 28220, 28087, 27952, 27816, 27678, 27539, 27398, 27256, 27112, 26967, 26820, 26673, 26523, 26373, 26221
	.dc.w	26068, 25913, 25758, 25601, 25443, 25283, 25123, 24962, 24799, 24635, 24471, 24305, 24138, 23970, 23802, 23632
	.dc.w	23462, 23291, 23118, 22945, 22772, 22597, 22422, 22246, 22069, 21892, 21714, 21535, 21356, 21176, 20996, 20815
	.dc.w	20634, 20453, 20271, 20088, 19905, 19722, 19539, 19355, 19171, 18987, 18803, 18618, 18433, 18249, 18064, 17879
	.dc.w	17694, 17509, 17324, 17139, 16954, 16769, 16585, 16401, 16216, 16032, 15849, 15665, 15482, 15299, 15117, 14935
	.dc.w	14753, 14572, 14391, 14211, 14031, 13852, 13674, 13496, 13318, 13142, 12966, 12790, 12616, 12442, 12269, 12097
	.dc.w	11926, 11755, 11586, 11417, 11249, 11083, 10917, 10752, 10588, 10426, 10264, 10104, 9945, 9787, 9630, 9474
	.dc.w	9320, 9167, 9015, 8864, 8715, 8567, 8420, 8275, 8132, 7989, 7849, 7709, 7571, 7435, 7300, 7167
	.dc.w	7036, 6906, 6777, 6651, 6526, 6402, 6280, 6160, 6042, 5926, 5811, 5698, 5587, 5478, 5370, 5265
	.dc.w	5161, 5059, 4959, 4861, 4765, 4671, 4579, 4489, 4401, 4314, 4230, 4148, 4068, 3990, 3914, 3840
	.dc.w	3768, 3699, 3631, 3565, 3502, 3441, 3382, 3325, 3270, 3217, 3167, 3119, 3073, 3029, 2987, 2948
	.dc.w	2910, 2876, 2843, 2812, 2784, 2758, 2734, 2713, 2693, 2676, 2662, 2649, 2639, 2631, 2625, 2622

#elif FFT_N == 256
	.dc.w	2621, 2625, 2639, 2662, 2693, 2734, 2784, 2843, 2910, 2987, 3073, 3167, 3270, 3382, 3502, 3631
	.dc.w	3768, 3914, 4068, 4230, 4401, 4579, 4765, 4959, 5161, 5370, 5587, 5811, 6042, 6280, 6525, 6777
	.dc.w	7036, 7300, 7571, 7849, 8132, 8420, 8715, 9015, 9320, 9630, 9945, 10264, 10588, 10917, 11249, 11586
	.dc.w	11926, 12269, 12616, 12966, 13318, 13674, 14031, 14391, 14753, 15117, 15482, 15849, 16216, 16585, 16954, 17324
	.dc.w	17694, 18064, 18433, 18802, 19171, 19539, 19905, 20271, 20634, 20996, 21356, 21714, 22069, 22422, 22772, 23118
	.dc.w	23462, 23802, 24138, 24471, 24799, 25123, 25443, 25758, 26068, 26373, 26673, 26967, 27256, 27539, 27816, 28087
	.dc.w	28352, 28610, 28862, 29107, 29345, 29576, 29800, 30017, 30226, 30428, 30622, 30808, 30987, 31157, 31319, 31473
	.dc.w	31619, 31756, 31885, 32006, 32117, 32220, 32315, 32400, 32477, 32545, 32603, 32653, 32694, 32726, 32748, 32762
	.dc.w	32766, 32762, 32748, 32726, 32694, 32653, 32603, 32545, 32477, 32400, 32315, 32221, 32117, 32006, 31885, 31757
	.dc.w	31619, 31473, 31319, 31157, 30987, 30808, 30622, 30428, 30226, 30017, 29800, 29576, 29345, 29107, 28862, 28610
	.dc.w	28352, 28087, 27816, 27539, 27256, 26967, 26673, 26373, 26068, 25758, 25443, 25123, 24799, 24471, 24138, 23802
	.dc.w	23462, 23118, 22772, 22422, 22069, 21714, 21356, 20996, 20634, 20271, 19905, 19539, 19171, 18803, 18433, 18064
	.dc.w	17694, 17324, 16954, 16585, 16216, 15849, 15482, 15117, 14753, 14391, 14031, 13674, 13318, 12966, 12616, 12269
	.dc.w	11926, 11586, 11249, 10917, 10588, 10264, 9945, 9630, 9320, 9015, 8715, 8420, 8132, 7849, 7571, 7300
	.dc.w	7036, 6777, 6526, 6280, 6042, 5811, 5587, 5370, 5161, 4959, 4765, 4579, 4401, 4230, 4068, 3914
	.dc.w	3768, 3631, 3502, 3382, 3270, 3167, 3073, 2987, 2910, 2843, 2784, 2734, 2693, 2662, 2639, 2625

#elif FFT_N == 128
	.dc.w	2621, 2639, 2693, 2784, 2910, 3073, 3270, 3502, 3768, 4068, 4401, 4765, 5161, 5587, 6042, 6525
	.dc.w	7036, 7571, 8132, 8715, 9320, 9945, 10588, 11249, 11926, 12616, 13318, 14031, 14753, 15482, 16216, 16954
	.dc.w	17694, 18433, 19171, 19905, 20634, 21356, 22069, 22772, 23462, 24138, 24799, 25443, 26068, 26673, 27256, 27816
	.dc.w	28352, 28862, 29345, 29800, 30226, 30622, 30987, 31319, 31619, 31885, 32117, 32315, 32477, 32603, 32694, 32748
	.dc.w	32766, 32748, 32694, 32603, 32477, 32315, 32117, 31885, 31619, 31319, 30987, 30622, 30226, 29800, 29345, 28862
	.dc.w	28352, 27816, 27256, 26673, 26068, 25443, 24799, 24138, 23462, 22772, 22069, 21356, 20634, 19905, 19171, 18433
	.dc.w	17694, 16954, 16216, 15482, 14753, 14031, 13318, 12616, 11926, 11249, 10588, 9945, 9320, 8715, 8132, 7571
	.dc.w	7036, 6526, 6042, 5587, 5161, 4765, 4401, 4068, 3768, 3502, 3270, 3073, 2910, 2784, 2693, 2639

#elif FFT_N == 64
	.dc.w	2621, 2693, 2910, 3270, 3768, 4401, 5161, 6042, 7036, 8132, 9320, 10588, 11926, 13318, 14753, 16216
	.dc.w	17694, 19171, 20634, 22069, 23462, 24799, 26068, 27256, 28352, 29345, 30226, 30987, 31619, 32117, 32477, 32694
	.dc.w	32766, 32694, 32477, 32117, 31619, 30987, 30226, 29345, 28352, 27256, 26068, 24799, 23462, 22069, 20634, 19171
	.dc.w	17694, 16216, 14753, 13318, 11926, 10588, 9320, 8132, 7036, 6042, 5161, 4401, 3768, 3270, 2910, 2693
#endif

tbl_cos_sin:	; Table of {cos(x),sin(x)}, (0 <= x < pi, in FFT_N/2 steps)
#if FFT_N == 2048
	.dc.w	32767, 0, 32767, 101, 32766, 201, 32766, 302, 32765, 402, 32763, 503, 32761, 603, 32759, 704
	.dc.w	32757, 804, 32755, 905, 32752, 1005, 32748, 1106, 32745, 1206, 32741, 1307, 32737, 1407, 32732, 1507
	.dc.w	32728, 1608, 32722, 1708, 32717, 1809, 32711, 1909, 32705, 2009, 32699, 2110, 32692, 2210, 32685, 2310
	.dc.w	32678, 2410, 32671, 2511, 32663, 2611, 32655, 2711, 32646, 2811, 32637, 2911, 32628, 3012, 32619, 3112
	.dc.w	32609, 3212, 32599, 3312, 32589, 3412, 32578, 3512, 32567, 3612, 32556, 3712, 32545, 3811, 32533, 3911
	.dc.w	32521, 4011, 32508, 4111, 32495, 4210, 32482, 4310, 32469, 4410, 32455, 4509, 32441, 4609, 32427, 4708
	.dc.w	32412, 4808, 32397, 4907, 32382, 5007, 32367, 5106, 32351, 5205, 32335, 5305, 32318, 5404, 32302, 5503
	.dc.w	32285, 5602, 32267, 5701, 32250, 5800, 32232, 5899, 32213, 5998, 32195, 6096, 32176, 6195, 32157, 6294
	.dc.w	32137, 6393, 32118, 6491, 32098, 6590, 32077, 6688, 32057, 6786, 32036, 6885, 32014, 6983, 31993, 7081
	.dc.w	31971, 7179, 31949, 7277, 31926, 7375, 31903, 7473, 31880, 7571, 31857, 7669, 31833, 7767, 31809, 7864
	.dc.w	31785, 7962, 31760, 8059, 31736, 8157, 31710, 8254, 31685, 8351, 31659, 8448, 31633, 8545, 31607, 8642
	.dc.w	31580, 8739, 31553, 8836, 31526, 8933, 31498, 9030, 31470, 9126, 31442, 9223, 31414, 9319, 31385, 9416
	.dc.w	31356, 9512, 31327, 9608, 31297, 9704, 31267, 9800, 31237, 9896, 31206, 9992, 31176, 10087, 31145, 10183
	.dc.w	31113, 10278, 31082, 10374, 31050, 10469, 31017, 10564, 30985, 10659, 30952, 10754, 30919, 10849, 30885, 10944
	.dc.w	30852, 11039, 30818, 11133, 30783, 11228, 30749, 11322, 30714, 11417, 30679, 11511, 30643, 11605, 30607, 11699
	.dc.w	30571, 11793, 30535, 11886, 30498, 11980, 30462, 12074, 30424, 12167, 30387, 12260, 30349, 12353, 30311, 12446
	.dc.w	30273, 12539, 30234, 12632, 30195, 12725, 30156, 12817, 30117, 12910, 30077, 13002, 30037, 13094, 29997, 13187
	.dc.w	29956, 13279, 29915, 13370, 29874, 13462, 29832, 13554, 29791, 13645, 29749, 13736, 29706, 13828, 29664, 13919
	.dc.w	29621, 14010, 29578, 14101, 29534, 14191, 29491, 14282, 29447, 14372, 29403, 14462, 29358, 14553, 29313, 14643
	.dc.w	29268, 14732, 29223, 14822, 29177, 14912, 29131, 15001, 29085, 15090, 29039, 15180, 28992, 15269, 28945, 15358
	.dc.w	28898, 15446, 28850, 15535, 28803, 15623, 28755, 15712, 28706, 15800, 28658, 15888, 28609, 15976, 28560, 16063
	.dc.w	28510, 16151, 28460, 16238, 28411, 16325, 28360, 16413, 28310, 16499, 28259, 16586, 28208, 16673, 28157, 16759
	.dc.w	28105, 16846, 28053, 16932, 28001, 17018, 27949, 17104, 27896, 17189, 27843, 17275, 27790, 17360, 27737, 17445
	.dc.w	27683, 17530, 27629, 17615, 27575, 17700, 27521, 17784, 27466, 17869, 27411, 17953, 27356, 18037, 27300, 18121
	.dc.w	27245, 18204, 27189, 18288, 27133, 18371, 27076, 18454, 27019, 18537, 26962, 18620, 26905, 18703, 26848, 18785
	.dc.w	26790, 18868, 26732, 18950, 26674, 19032, 26615, 19113, 26556, 19195, 26497, 19276, 26438, 19357, 26378, 19438
	.dc.w	26319, 19519, 26259, 19600, 26198, 19680, 26138, 19761, 26077, 19841, 26016, 19921, 25955, 20000, 25893, 20080
	.dc.w	25832, 20159, 25770, 20238, 25708, 20317, 25645, 20396, 25582, 20475, 25519, 20553, 25456, 20631, 25393, 20709
	.dc.w	25329, 20787, 25265, 20865, 25201, 20942, 25137, 21019, 25072, 21096, 25007, 21173, 24942, 21250, 24877, 21326
	.dc.w	24811, 21403, 24746, 21479, 24680, 21554, 24613, 21630, 24547, 21705, 24480, 21781, 24413, 21856, 24346, 21930
	.dc.w	24279, 22005, 24211, 22079, 24143, 22154, 24075, 22227, 24007, 22301, 23938, 22375, 23870, 22448, 23801, 22521
	.dc.w	23731, 22594, 23662, 22667, 23592, 22739, 23522, 22812, 23452, 22884, 23382, 22956, 23311, 23027, 23241, 23099
	.dc.w	23170, 23170, 23099, 23241, 23027, 23311, 22956, 23382, 22884, 23452, 22812, 23522, 22739, 23592, 22667, 23662
	.dc.w	22594, 23731, 22521, 23801, 22448, 23870, 22375, 23938, 22301, 24007, 22227, 24075, 22154, 24143, 22079, 24211
	.dc.w	22005, 24279, 21930, 24346, 21856, 24413, 21781, 24480, 21705, 24547, 21630, 24613, 21554, 24680, 21479, 24746
	.dc.w	21403, 24811, 21326, 24877, 21250, 24942, 21173, 25007, 21096, 25072, 21019, 25137, 20942, 25201, 20865, 25265
	.dc.w	20787, 25329, 20709, 25393, 20631, 25456, 20553, 25519, 20475, 25582, 20396, 25645, 20317, 25708, 20238, 25770
	.dc.w	20159, 25832, 20080, 25893, 20000, 25955, 19921, 26016, 19841, 26077, 19761, 26138, 19680, 26198, 19600, 26259
	.dc.w	19519, 26319, 19438, 26378, 19357, 26438, 19276, 26497, 19195, 26556, 19113, 26615, 19032, 26674, 18950, 26732
	.dc.w	18868, 26790, 18785, 26848, 18703, 26905, 18620, 26962, 18537, 27019, 18454, 27076, 18371, 27133, 18288, 27189
	.dc.w	18204, 27245, 18121, 27300, 18037, 27356, 17953, 27411, 17869, 27466, 17784, 27521, 17700, 27575, 17615, 27629
	.dc.w	17530, 27683, 17445, 27737, 17360, 27790, 17275, 27843, 17189, 27896, 17104, 27949, 17018, 28001, 16932, 28053
	.dc.w	16846, 28105, 16759, 28157, 16673, 28208, 16586, 28259, 16499, 28310, 16413, 28360, 16325, 28411, 16238, 28460
	.dc.w	16151, 28510, 16063, 28560, 15976, 28609, 15888, 28658, 15800, 28706, 15712, 28755, 15623, 28803, 15535, 28850
	.dc.w	15446, 28898, 15358, 28945, 15269, 28992, 15180, 29039, 15090, 29085, 15001, 29131, 14912, 29177, 14822, 29223
	.dc.w	14732, 29268, 14643, 29313, 14553, 29358, 14462, 29403, 14372, 29447, 14282, 29491, 14191, 29534, 14101, 29578
	.dc.w	14010, 29621, 13919, 29664, 13828, 29706, 13736, 29749, 13645, 29791, 13554, 29832, 13462, 29874, 13370, 29915
	.dc.w	13279, 29956, 13187, 29997, 13094, 30037, 13002, 30077, 12910, 30117, 12817, 30156, 12725, 30195, 12632, 30234
	.dc.w	12539, 30273, 12446, 30311, 12353, 30349, 12260, 30387, 12167, 30424, 12074, 30462, 11980, 30498, 11886, 30535
	.dc.w	11793, 30571, 11699, 30607, 11605, 30643, 11511, 30679, 11417, 30714, 11322, 30749, 11228, 30783, 11133, 30818
	.dc.w	11039, 30852, 10944, 30885, 10849, 30919, 10754, 30952, 10659, 30985, 10564, 31017, 10469, 31050, 10374, 31082
	.dc.w	10278, 31113, 10183, 31145, 10087, 31176, 9992, 31206, 9896, 31237, 9800, 31267, 9704, 31297, 9608, 31327
	.dc.w	9512, 31356, 9416, 31385, 9319, 31414, 9223, 31442, 9126, 31470, 9030, 31498, 8933, 31526, 8836, 31553
	.dc.w	8739, 31580, 8642, 31607, 8545, 31633, 8448, 31659, 8351, 31685, 8254, 31710, 8157, 31736, 8059, 31760
	.dc.w	7962, 31785, 7864, 31809, 7767, 31833, 7669, 31857, 7571, 31880, 7473, 31903, 7375, 31926, 7277, 31949
	.dc.w	7179, 31971, 7081, 31993, 6983, 32014, 6885, 32036, 6786, 32057, 6688, 32077, 6590, 32098, 6491, 32118
	.dc.w	6393, 32137, 6294, 32157, 6195, 32176, 6096, 32195, 5998, 32213, 5899, 32232, 5800, 32250, 5701, 32267
	.dc.w	5602, 32285, 5503, 32302, 5404, 32318, 5305, 32335, 5205, 32351, 5106, 32367, 5007, 32382, 4907, 32397
	.dc.w	4808, 32412, 4708, 32427, 4609, 32441, 4509, 32455, 4410, 32469, 4310, 32482, 4210, 32495, 4111, 32508
	.dc.w	4011, 32521, 3911, 32533, 3811, 32545, 3712, 32556, 3612, 32567, 3512, 32578, 3412, 32589, 3312, 32599
	.dc.w	3212, 32609, 3112, 32619, 3012, 32628, 2911, 32637, 2811, 32646, 2711, 32655, 2611, 32663, 2511, 32671
	.dc.w	2410, 32678, 2310, 32685, 2210, 32692, 2110, 32699, 2009, 32705, 1909, 32711, 1809, 32717, 1708, 32722
	.dc.w	1608, 32728, 1507, 32732, 1407, 32737, 1307, 32741, 1206, 32745, 1106, 32748, 1005, 32752, 905, 32755
	.dc.w	804, 32757, 704, 32759, 603, 32761, 503, 32763, 402, 32765, 302, 32766, 201, 32766, 101, 32767
	.dc.w	0, 32767, -101, 32767, -201, 32766, -302, 32766, -402, 32765, -503, 32763, -603, 32761, -704, 32759
	.dc.w	-804, 32757, -905, 32755, -1005, 32752, -1106, 32748, -1206, 32745, -1307, 32741, -1407, 32737, -1507, 32732
	.dc.w	-1608, 32728, -1708, 32722, -1809, 32717, -1909, 32711, -2009, 32705, -2110, 32699, -2210, 32692, -2310, 32685
	.dc.w	-2410, 32678, -2511, 32671, -2611, 32663, -2711, 32655, -2811, 32646, -2911, 32637, -3012, 32628, -3112, 32619
	.dc.w	-3212, 32609, -3312, 32599, -3412, 32589, -3512, 32578, -3612, 32567, -3712, 32556, -3811, 32545, -3911, 32533
	.dc.w	-4011, 32521, -4111, 32508, -4210, 32495, -4310, 32482, -4410, 32469, -4509, 32455, -4609, 32441, -4708, 32427
	.dc.w	-4808, 32412, -4907, 32397, -5007, 32382, -5106, 32367, -5205, 32351, -5305, 32335, -5404, 32318, -5503, 32302
	.dc.w	-5602, 32285, -5701, 32267, -5800, 32250, -5899, 32232, -5998, 32213, -6096, 32195, -6195, 32176, -6294, 32157
	.dc.w	-6393, 32137, -6491, 32118, -6590, 32098, -6688, 32077, -6786, 32057, -6885, 32036, -6983, 32014, -7081, 31993
	.dc.w	-7179, 31971, -7277, 31949, -7375, 31926, -7473, 31903, -7571, 31880, -7669, 31857, -7767, 31833, -7864, 31809
	.dc.w	-7962, 31785, -8059, 31760, -8157, 31736, -8254, 31710, -8351, 31685, -8448, 31659, -8545, 31633, -8642, 31607
	.dc.w	-8739, 31580, -8836, 31553, -8933, 31526, -9030, 31498, -9126, 31470, -9223, 31442, -9319, 31414, -9416, 31385
	.dc.w	-9512, 31356, -9608, 31327, -9704, 31297, -9800, 31267, -9896, 31237, -9992, 31206, -10087, 31176, -10183, 31145
	.dc.w	-10278, 31113, -10374, 31082, -10469, 31050, -10564, 31017, -10659, 30985, -10754, 30952, -10849, 30919, -10944, 30885
	.dc.w	-11039, 30852, -11133, 30818, -11228, 30783, -11322, 30749, -11417, 30714, -11511, 30679, -11605, 30643, -11699, 30607
	.dc.w	-11793, 30571, -11886, 30535, -11980, 30498, -12074, 30462, -12167, 30424, -12260, 30387, -12353, 30349, -12446, 30311
	.dc.w	-12539, 30273, -12632, 30234, -12725, 30195, -12817, 30156, -12910, 30117, -13002, 30077, -13094, 30037, -13187, 29997
	.dc.w	-13279, 29956, -13370, 29915, -13462, 29874, -13554, 29832, -13645, 29791, -13736, 29749, -13828, 29706, -13919, 29664
	.dc.w	-14010, 29621, -14101, 29578, -14191, 29534, -14282, 29491, -14372, 29447, -14462, 29403, -14553, 29358, -14643, 29313
	.dc.w	-14732, 29268, -14822, 29223, -14912, 29177, -15001, 29131, -15090, 29085, -15180, 29039, -15269, 28992, -15358, 28945
	.dc.w	-15446, 28898, -15535, 28850, -15623, 28803, -15712, 28755, -15800, 28706, -15888, 28658, -15976, 28609, -16063, 28560
	.dc.w	-16151, 28510, -16238, 28460, -16325, 28411, -16413, 28360, -16499, 28310, -16586, 28259, -16673, 28208, -16759, 28157
	.dc.w	-16846, 28105, -16932, 28053, -17018, 28001, -17104, 27949, -17189, 27896, -17275, 27843, -17360, 27790, -17445, 27737
	.dc.w	-17530, 27683, -17615, 27629, -17700, 27575, -17784, 27521, -17869, 27466, -17953, 27411, -18037, 27356, -18121, 27300
	.dc.w	-18204, 27245, -18288, 27189, -18371, 27133, -18454, 27076, -18537, 27019, -18620, 26962, -18703, 26905, -18785, 26848
	.dc.w	-18868, 26790, -18950, 26732, -19032, 26674, -19113, 26615, -19195, 26556, -19276, 26497, -19357, 26438, -19438, 26378
	.dc.w	-19519, 26319, -19600, 26259, -19680, 26198, -19761, 26138, -19841, 26077, -19921, 26016, -20000, 25955, -20080, 25893
	.dc.w	-20159, 25832, -20238, 25770, -20317, 25708, -20396, 25645, -20475, 25582, -20553, 25519, -20631, 25456, -20709, 25393
	.dc.w	-20787, 25329, -20865, 25265, -20942, 25201, -21019, 25137, -21096, 25072, -21173, 25007, -21250, 24942, -21326, 24877
	.dc.w	-21403, 24811, -21479, 24746, -21554, 24680, -21630, 24613, -21705, 24547, -21781, 24480, -21856, 24413, -21930, 24346
	.dc.w	-22005, 24279, -22079, 24211, -22154, 24143, -22227, 24075, -22301, 24007, -22375, 23938, -22448, 23870, -22521, 23801
	.dc.w	-22594, 23731, -22667, 23662, -22739, 23592, -22812, 23522, -22884, 23452, -22956, 23382, -23027, 23311, -23099, 23241
	.dc.w	-23170, 23170, -23241, 23099, -23311, 23027, -23382, 22956, -23452, 22884, -23522, 22812, -23592, 22739, -23662, 22667
	.dc.w	-23731, 22594, -23801, 22521, -23870, 22448, -23938, 22375, -24007, 22301, -24075, 22227, -24143, 22154, -24211, 22079
	.dc.w	-24279, 22005, -24346, 21930, -24413, 21856, -24480, 21781, -24547, 21705, -24613, 21630, -24680, 21554, -24746, 21479
	.dc.w	-24811, 21403, -24877, 21326, -24942, 21250, -25007, 21173, -25072, 21096, -25137, 21019, -25201, 20942, -25265, 20865
	.dc.w	-25329, 20787, -25393, 20709, -25456, 20631, -25519, 20553, -25582, 20475, -25645, 20396, -25708, 20317, -25770, 20238
	.dc.w	-25832, 20159, -25893, 20080, -25955, 20000, -26016, 19921, -26077, 19841, -26138, 19761, -26198, 19680, -26259, 19600
	.dc.w	-26319, 19519, -26378, 19438, -26438, 19357, -26497, 19276, -26556, 19195, -26615, 19113, -26674, 19032, -26732, 18950
	.dc.w	-26790, 18868, -26848, 18785, -26905, 18703, -26962, 18620, -27019, 18537, -27076, 18454, -27133, 18371, -27189, 18288
	.dc.w	-27245, 18204, -27300, 18121, -27356, 18037, -27411, 17953, -27466, 17869, -27521, 17784, -27575, 17700, -27629, 17615
	.dc.w	-27683, 17530, -27737, 17445, -27790, 17360, -27843, 17275, -27896, 17189, -27949, 17104, -28001, 17018, -28053, 16932
	.dc.w	-28105, 16846, -28157, 16759, -28208, 16673, -28259, 16586, -28310, 16499, -28360, 16413, -28411, 16325, -28460, 16238
	.dc.w	-28510, 16151, -28560, 16063, -28609, 15976, -28658, 15888, -28706, 15800, -28755, 15712, -28803, 15623, -28850, 15535
	.dc.w	-28898, 15446, -28945, 15358, -28992, 15269, -29039, 15180, -29085, 15090, -29131, 15001, -29177, 14912, -29223, 14822
	.dc.w	-29268, 14732, -29313, 14643, -29358, 14553, -29403, 14462, -29447, 14372, -29491, 14282, -29534, 14191, -29578, 14101
	.dc.w	-29621, 14010, -29664, 13919, -29706, 13828, -29749, 13736, -29791, 13645, -29832, 13554, -29874, 13462, -29915, 13370
	.dc.w	-29956, 13279, -29997, 13187, -30037, 13094, -30077, 13002, -30117, 12910, -30156, 12817, -30195, 12725, -30234, 12632
	.dc.w	-30273, 12539, -30311, 12446, -30349, 12353, -30387, 12260, -30424, 12167, -30462, 12074, -30498, 11980, -30535, 11886
	.dc.w	-30571, 11793, -30607, 11699, -30643, 11605, -30679, 11511, -30714, 11417, -30749, 11322, -30783, 11228, -30818, 11133
	.dc.w	-30852, 11039, -30885, 10944, -30919, 10849, -30952, 10754, -30985, 10659, -31017, 10564, -31050, 10469, -31082, 10374
	.dc.w	-31113, 10278, -31145, 10183, -31176, 10087, -31206, 9992, -31237, 9896, -31267, 9800, -31297, 9704, -31327, 9608
	.dc.w	-31356, 9512, -31385, 9416, -31414, 9319, -31442, 9223, -31470, 9126, -31498, 9030, -31526, 8933, -31553, 8836
	.dc.w	-31580, 8739, -31607, 8642, -31633, 8545, -31659, 8448, -31685, 8351, -31710, 8254, -31736, 8157, -31760, 8059
	.dc.w	-31785, 7962, -31809, 7864, -31833, 7767, -31857, 7669, -31880, 7571, -31903, 7473, -31926, 7375, -31949, 7277
	.dc.w	-31971, 7179, -31993, 7081, -32014, 6983, -32036, 6885, -32057, 6786, -32077, 6688, -32098, 6590, -32118, 6491
	.dc.w	-32137, 6393, -32157, 6294, -32176, 6195, -32195, 6096, -32213, 5998, -32232, 5899, -32250, 5800, -32267, 5701
	.dc.w	-32285, 5602, -32302, 5503, -32318, 5404, -32335, 5305, -32351, 5205, -32367, 5106, -32382, 5007, -32397, 4907
	.dc.w	-32412, 4808, -32427, 4708, -32441, 4609, -32455, 4509, -32469, 4410, -32482, 4310, -32495, 4210, -32508, 4111
	.dc.w	-32521, 4011, -32533, 3911, -32545, 3811, -32556, 3712, -32567, 3612, -32578, 3512, -32589, 3412, -32599, 3312
	.dc.w	-32609, 3212, -32619, 3112, -32628, 3012, -32637, 2911, -32646, 2811, -32655, 2711, -32663, 2611, -32671, 2511
	.dc.w	-32678, 2410, -32685, 2310, -32692, 2210, -32699, 2110, -32705, 2009, -32711, 1909, -32717, 1809, -32722, 1708
	.dc.w	-32728, 1608, -32732, 1507, -32737, 1407, -32741, 1307, -32745, 1206, -32748, 1106, -32752, 1005, -32755, 905
	.dc.w	-32757, 804, -32759, 704, -32761, 603, -32763, 503, -32765, 402, -32766, 302, -32766, 201, -32767, 101

#elif FFT_N == 512
	.dc.w	32767, 0, 32764, 402, 32757, 804, 32744, 1206, 32727, 1607, 32705, 2009, 32678, 2410, 32646, 2811
	.dc.w	32609, 3211, 32567, 3611, 32520, 4011, 32468, 4409, 32412, 4807, 32350, 5205, 32284, 5601, 32213, 5997
	.dc.w	32137, 6392, 32056, 6786, 31970, 7179, 31880, 7571, 31785, 7961, 31684, 8351, 31580, 8739, 31470, 9126
	.dc.w	31356, 9511, 31236, 9895, 31113, 10278, 30984, 10659, 30851, 11038, 30713, 11416, 30571, 11792, 30424, 12166
	.dc.w	30272, 12539, 30116, 12909, 29955, 13278, 29790, 13645, 29621, 14009, 29446, 14372, 29268, 14732, 29085, 15090
	.dc.w	28897, 15446, 28706, 15799, 28510, 16150, 28309, 16499, 28105, 16845, 27896, 17189, 27683, 17530, 27466, 17868
	.dc.w	27244, 18204, 27019, 18537, 26789, 18867, 26556, 19194, 26318, 19519, 26077, 19840, 25831, 20159, 25582, 20474
	.dc.w	25329, 20787, 25072, 21096, 24811, 21402, 24546, 21705, 24278, 22004, 24006, 22301, 23731, 22594, 23452, 22883
	.dc.w	23169, 23169, 22883, 23452, 22594, 23731, 22301, 24006, 22004, 24278, 21705, 24546, 21402, 24811, 21096, 25072
	.dc.w	20787, 25329, 20474, 25582, 20159, 25831, 19840, 26077, 19519, 26318, 19194, 26556, 18867, 26789, 18537, 27019
	.dc.w	18204, 27244, 17868, 27466, 17530, 27683, 17189, 27896, 16845, 28105, 16499, 28309, 16150, 28510, 15799, 28706
	.dc.w	15446, 28897, 15090, 29085, 14732, 29268, 14372, 29446, 14009, 29621, 13645, 29790, 13278, 29955, 12909, 30116
	.dc.w	12539, 30272, 12166, 30424, 11792, 30571, 11416, 30713, 11038, 30851, 10659, 30984, 10278, 31113, 9895, 31236
	.dc.w	9511, 31356, 9126, 31470, 8739, 31580, 8351, 31684, 7961, 31785, 7571, 31880, 7179, 31970, 6786, 32056
	.dc.w	6392, 32137, 5997, 32213, 5601, 32284, 5205, 32350, 4807, 32412, 4409, 32468, 4011, 32520, 3611, 32567
	.dc.w	3211, 32609, 2811, 32646, 2410, 32678, 2009, 32705, 1607, 32727, 1206, 32744, 804, 32757, 402, 32764
	.dc.w	0, 32766, -402, 32764, -804, 32757, -1206, 32744, -1607, 32727, -2009, 32705, -2410, 32678, -2811, 32646
	.dc.w	-3211, 32609, -3611, 32567, -4010, 32520, -4409, 32468, -4807, 32412, -5205, 32350, -5601, 32284, -5997, 32213
	.dc.w	-6392, 32137, -6786, 32056, -7179, 31970, -7571, 31880, -7961, 31785, -8351, 31684, -8739, 31580, -9126, 31470
	.dc.w	-9511, 31356, -9895, 31236, -10278, 31113, -10659, 30984, -11038, 30851, -11416, 30713, -11792, 30571, -12166, 30424
	.dc.w	-12539, 30272, -12909, 30116, -13278, 29955, -13645, 29790, -14009, 29621, -14372, 29446, -14732, 29268, -15090, 29085
	.dc.w	-15446, 28897, -15799, 28706, -16150, 28510, -16499, 28309, -16845, 28105, -17189, 27896, -17530, 27683, -17868, 27466
	.dc.w	-18204, 27244, -18537, 27019, -18867, 26789, -19194, 26556, -19519, 26318, -19840, 26077, -20159, 25831, -20474, 25582
	.dc.w	-20787, 25329, -21096, 25072, -21402, 24811, -21705, 24546, -22004, 24278, -22301, 24006, -22594, 23731, -22883, 23452
	.dc.w	-23169, 23169, -23452, 22883, -23731, 22594, -24006, 22301, -24278, 22005, -24546, 21705, -24811, 21402, -25072, 21096
	.dc.w	-25329, 20787, -25582, 20474, -25831, 20159, -26077, 19840, -26318, 19519, -26556, 19194, -26789, 18867, -27019, 18537
	.dc.w	-27244, 18204, -27466, 17868, -27683, 17530, -27896, 17189, -28105, 16845, -28309, 16499, -28510, 16150, -28706, 15799
	.dc.w	-28897, 15446, -29085, 15090, -29268, 14732, -29446, 14372, -29620, 14009, -29790, 13645, -29955, 13278, -30116, 12910
	.dc.w	-30272, 12539, -30424, 12167, -30571, 11792, -30713, 11416, -30851, 11038, -30984, 10659, -31113, 10278, -31236, 9895
	.dc.w	-31356, 9511, -31470, 9126, -31580, 8739, -31684, 8351, -31784, 7961, -31880, 7571, -31970, 7179, -32056, 6786
	.dc.w	-32137, 6392, -32213, 5997, -32284, 5601, -32350, 5205, -32412, 4807, -32468, 4409, -32520, 4011, -32567, 3611
	.dc.w	-32609, 3211, -32646, 2811, -32678, 2410, -32705, 2009, -32727, 1607, -32744, 1206, -32757, 804, -32764, 402

#elif FFT_N == 256
	.dc.w	32767, 0, 32757, 804, 32727, 1607, 32678, 2410, 32609, 3211, 32520, 4011, 32412, 4807, 32284, 5601
	.dc.w	32137, 6392, 31970, 7179, 31785, 7961, 31580, 8739, 31356, 9511, 31113, 10278, 30851, 11038, 30571, 11792
	.dc.w	30272, 12539, 29955, 13278, 29621, 14009, 29268, 14732, 28897, 15446, 28510, 16150, 28105, 16845, 27683, 17530
	.dc.w	27244, 18204, 26789, 18867, 26318, 19519, 25831, 20159, 25329, 20787, 24811, 21402, 24278, 22004, 23731, 22594
	.dc.w	23169, 23169, 22594, 23731, 22004, 24278, 21402, 24811, 20787, 25329, 20159, 25831, 19519, 26318, 18867, 26789
	.dc.w	18204, 27244, 17530, 27683, 16845, 28105, 16150, 28510, 15446, 28897, 14732, 29268, 14009, 29621, 13278, 29955
	.dc.w	12539, 30272, 11792, 30571, 11038, 30851, 10278, 31113, 9511, 31356, 8739, 31580, 7961, 31785, 7179, 31970
	.dc.w	6392, 32137, 5601, 32284, 4807, 32412, 4011, 32520, 3211, 32609, 2410, 32678, 1607, 32727, 804, 32757
	.dc.w	0, 32766, -804, 32757, -1607, 32727, -2410, 32678, -3211, 32609, -4010, 32520, -4807, 32412, -5601, 32284
	.dc.w	-6392, 32137, -7179, 31970, -7961, 31785, -8739, 31580, -9511, 31356, -10278, 31113, -11038, 30851, -11792, 30571
	.dc.w	-12539, 30272, -13278, 29955, -14009, 29621, -14732, 29268, -15446, 28897, -16150, 28510, -16845, 28105, -17530, 27683
	.dc.w	-18204, 27244, -18867, 26789, -19519, 26318, -20159, 25831, -20787, 25329, -21402, 24811, -22004, 24278, -22594, 23731
	.dc.w	-23169, 23169, -23731, 22594, -24278, 22005, -24811, 21402, -25329, 20787, -25831, 20159, -26318, 19519, -26789, 18867
	.dc.w	-27244, 18204, -27683, 17530, -28105, 16845, -28510, 16150, -28897, 15446, -29268, 14732, -29620, 14009, -29955, 13278
	.dc.w	-30272, 12539, -30571, 11792, -30851, 11038, -31113, 10278, -31356, 9511, -31580, 8739, -31784, 7961, -31970, 7179
	.dc.w	-32137, 6392, -32284, 5601, -32412, 4807, -32520, 4011, -32609, 3211, -32678, 2410, -32727, 1607, -32757, 804

#elif FFT_N == 128
	.dc.w	32767, 0, 32727, 1607, 32609, 3211, 32412, 4807, 32137, 6392, 31785, 7961, 31356, 9511, 30851, 11038
	.dc.w	30272, 12539, 29621, 14009, 28897, 15446, 28105, 16845, 27244, 18204, 26318, 19519, 25329, 20787, 24278, 22004
	.dc.w	23169, 23169, 22004, 24278, 20787, 25329, 19519, 26318, 18204, 27244, 16845, 28105, 15446, 28897, 14009, 29621
	.dc.w	12539, 30272, 11038, 30851, 9511, 31356, 7961, 31785, 6392, 32137, 4807, 32412, 3211, 32609, 1607, 32727
	.dc.w	0, 32766, -1607, 32727, -3211, 32609, -4807, 32412, -6392, 32137, -7961, 31785, -9511, 31356, -11038, 30851
	.dc.w	-12539, 30272, -14009, 29621, -15446, 28897, -16845, 28105, -18204, 27244, -19519, 26318, -20787, 25329, -22004, 24278
	.dc.w	-23169, 23169, -24278, 22005, -25329, 20787, -26318, 19519, -27244, 18204, -28105, 16845, -28897, 15446, -29620, 14009
	.dc.w	-30272, 12539, -30851, 11038, -31356, 9511, -31784, 7961, -32137, 6392, -32412, 4807, -32609, 3211, -32727, 1607

#elif FFT_N == 64
	.dc.w	32767, 0, 32609, 3211, 32137, 6392, 31356, 9511, 30272, 12539, 28897, 15446, 27244, 18204, 25329, 20787
	.dc.w	23169, 23169, 20787, 25329, 18204, 27244, 15446, 28897, 12539, 30272, 9511, 31356, 6392, 32137, 3211, 32609
	.dc.w	0, 32766, -3211, 32609, -6392, 32137, -9511, 31356, -12539, 30272, -15446, 28897, -18204, 27244, -20787, 25329
	.dc.w	-23169, 23169, -25329, 20787, -27244, 18204, -28897, 15446, -30272, 12539, -31356, 9511, -32137, 6392, -32609, 3211
#endif



tbl_bitrev:		; tbl_bitrev[] = ...
#if FFT_N == 2048
#ifdef INPUT_IQ
#endif
	.dc.w	0*4, 1024*4, 512*4, 1536*4, 256*4, 1280*4, 768*4, 1792*4, 128*4, 1152*4, 640*4, 1664*4, 384*4, 1408*4, 896*4, 1920*4
	.dc.w	64*4, 1088*4, 576*4, 1600*4, 320*4, 1344*4, 832*4, 1856*4, 192*4, 1216*4, 704*4, 1728*4, 448*4, 1472*4, 960*4, 1984*4
	.dc.w	32*4, 1056*4, 544*4, 1568*4, 288*4, 1312*4, 800*4, 1824*4, 160*4, 1184*4, 672*4, 1696*4, 416*4, 1440*4, 928*4, 1952*4
	.dc.w	96*4, 1120*4, 608*4, 1632*4, 352*4, 1376*4, 864*4, 1888*4, 224*4, 1248*4, 736*4, 1760*4, 480*4, 1504*4, 992*4, 2016*4
	.dc.w	16*4, 1040*4, 528*4, 1552*4, 272*4, 1296*4, 784*4, 1808*4, 144*4, 1168*4, 656*4, 1680*4, 400*4, 1424*4, 912*4, 1936*4
	.dc.w	80*4, 1104*4, 592*4, 1616*4, 336*4, 1360*4, 848*4, 1872*4, 208*4, 1232*4, 720*4, 1744*4, 464*4, 1488*4, 976*4, 2000*4
	.dc.w	48*4, 1072*4, 560*4, 1584*4, 304*4, 1328*4, 816*4, 1840*4, 176*4, 1200*4, 688*4, 1712*4, 432*4, 1456*4, 944*4, 1968*4
	.dc.w	112*4, 1136*4, 624*4, 1648*4, 368*4, 1392*4, 880*4, 1904*4, 240*4, 1264*4, 752*4, 1776*4, 496*4, 1520*4, 1008*4, 2032*4
	.dc.w	8*4, 1032*4, 520*4, 1544*4, 264*4, 1288*4, 776*4, 1800*4, 136*4, 1160*4, 648*4, 1672*4, 392*4, 1416*4, 904*4, 1928*4
	.dc.w	72*4, 1096*4, 584*4, 1608*4, 328*4, 1352*4, 840*4, 1864*4, 200*4, 1224*4, 712*4, 1736*4, 456*4, 1480*4, 968*4, 1992*4
	.dc.w	40*4, 1064*4, 552*4, 1576*4, 296*4, 1320*4, 808*4, 1832*4, 168*4, 1192*4, 680*4, 1704*4, 424*4, 1448*4, 936*4, 1960*4
	.dc.w	104*4, 1128*4, 616*4, 1640*4, 360*4, 1384*4, 872*4, 1896*4, 232*4, 1256*4, 744*4, 1768*4, 488*4, 1512*4, 1000*4, 2024*4
	.dc.w	24*4, 1048*4, 536*4, 1560*4, 280*4, 1304*4, 792*4, 1816*4, 152*4, 1176*4, 664*4, 1688*4, 408*4, 1432*4, 920*4, 1944*4
	.dc.w	88*4, 1112*4, 600*4, 1624*4, 344*4, 1368*4, 856*4, 1880*4, 216*4, 1240*4, 728*4, 1752*4, 472*4, 1496*4, 984*4, 2008*4
	.dc.w	56*4, 1080*4, 568*4, 1592*4, 312*4, 1336*4, 824*4, 1848*4, 184*4, 1208*4, 696*4, 1720*4, 440*4, 1464*4, 952*4, 1976*4
	.dc.w	120*4, 1144*4, 632*4, 1656*4, 376*4, 1400*4, 888*4, 1912*4, 248*4, 1272*4, 760*4, 1784*4, 504*4, 1528*4, 1016*4, 2040*4
	.dc.w	4*4, 1028*4, 516*4, 1540*4, 260*4, 1284*4, 772*4, 1796*4, 132*4, 1156*4, 644*4, 1668*4, 388*4, 1412*4, 900*4, 1924*4
	.dc.w	68*4, 1092*4, 580*4, 1604*4, 324*4, 1348*4, 836*4, 1860*4, 196*4, 1220*4, 708*4, 1732*4, 452*4, 1476*4, 964*4, 1988*4
	.dc.w	36*4, 1060*4, 548*4, 1572*4, 292*4, 1316*4, 804*4, 1828*4, 164*4, 1188*4, 676*4, 1700*4, 420*4, 1444*4, 932*4, 1956*4
	.dc.w	100*4, 1124*4, 612*4, 1636*4, 356*4, 1380*4, 868*4, 1892*4, 228*4, 1252*4, 740*4, 1764*4, 484*4, 1508*4, 996*4, 2020*4
	.dc.w	20*4, 1044*4, 532*4, 1556*4, 276*4, 1300*4, 788*4, 1812*4, 148*4, 1172*4, 660*4, 1684*4, 404*4, 1428*4, 916*4, 1940*4
	.dc.w	84*4, 1108*4, 596*4, 1620*4, 340*4, 1364*4, 852*4, 1876*4, 212*4, 1236*4, 724*4, 1748*4, 468*4, 1492*4, 980*4, 2004*4
	.dc.w	52*4, 1076*4, 564*4, 1588*4, 308*4, 1332*4, 820*4, 1844*4, 180*4, 1204*4, 692*4, 1716*4, 436*4, 1460*4, 948*4, 1972*4
	.dc.w	116*4, 1140*4, 628*4, 1652*4, 372*4, 1396*4, 884*4, 1908*4, 244*4, 1268*4, 756*4, 1780*4, 500*4, 1524*4, 1012*4, 2036*4
	.dc.w	12*4, 1036*4, 524*4, 1548*4, 268*4, 1292*4, 780*4, 1804*4, 140*4, 1164*4, 652*4, 1676*4, 396*4, 1420*4, 908*4, 1932*4
	.dc.w	76*4, 1100*4, 588*4, 1612*4, 332*4, 1356*4, 844*4, 1868*4, 204*4, 1228*4, 716*4, 1740*4, 460*4, 1484*4, 972*4, 1996*4
	.dc.w	44*4, 1068*4, 556*4, 1580*4, 300*4, 1324*4, 812*4, 1836*4, 172*4, 1196*4, 684*4, 1708*4, 428*4, 1452*4, 940*4, 1964*4
	.dc.w	108*4, 1132*4, 620*4, 1644*4, 364*4, 1388*4, 876*4, 1900*4, 236*4, 1260*4, 748*4, 1772*4, 492*4, 1516*4, 1004*4, 2028*4
	.dc.w	28*4, 1052*4, 540*4, 1564*4, 284*4, 1308*4, 796*4, 1820*4, 156*4, 1180*4, 668*4, 1692*4, 412*4, 1436*4, 924*4, 1948*4
	.dc.w	92*4, 1116*4, 604*4, 1628*4, 348*4, 1372*4, 860*4, 1884*4, 220*4, 1244*4, 732*4, 1756*4, 476*4, 1500*4, 988*4, 2012*4
	.dc.w	60*4, 1084*4, 572*4, 1596*4, 316*4, 1340*4, 828*4, 1852*4, 188*4, 1212*4, 700*4, 1724*4, 444*4, 1468*4, 956*4, 1980*4
	.dc.w	124*4, 1148*4, 636*4, 1660*4, 380*4, 1404*4, 892*4, 1916*4, 252*4, 1276*4, 764*4, 1788*4, 508*4, 1532*4, 1020*4, 2044*4
	.dc.w	2*4, 1026*4, 514*4, 1538*4, 258*4, 1282*4, 770*4, 1794*4, 130*4, 1154*4, 642*4, 1666*4, 386*4, 1410*4, 898*4, 1922*4	
	.dc.w	66*4, 1090*4, 578*4, 1602*4, 322*4, 1346*4, 834*4, 1858*4, 194*4, 1218*4, 706*4, 1730*4, 450*4, 1474*4, 962*4, 1986*4
	.dc.w	34*4, 1058*4, 546*4, 1570*4, 290*4, 1314*4, 802*4, 1826*4, 162*4, 1186*4, 674*4, 1698*4, 418*4, 1442*4, 930*4, 1954*4
	.dc.w	98*4, 1122*4, 610*4, 1634*4, 354*4, 1378*4, 866*4, 1890*4, 226*4, 1250*4, 738*4, 1762*4, 482*4, 1506*4, 994*4, 2018*4
	.dc.w	18*4, 1042*4, 530*4, 1554*4, 274*4, 1298*4, 786*4, 1810*4, 146*4, 1170*4, 658*4, 1682*4, 402*4, 1426*4, 914*4, 1938*4
	.dc.w	82*4, 1106*4, 594*4, 1618*4, 338*4, 1362*4, 850*4, 1874*4, 210*4, 1234*4, 722*4, 1746*4, 466*4, 1490*4, 978*4, 2002*4
	.dc.w	50*4, 1074*4, 562*4, 1586*4, 306*4, 1330*4, 818*4, 1842*4, 178*4, 1202*4, 690*4, 1714*4, 434*4, 1458*4, 946*4, 1970*4
	.dc.w	114*4, 1138*4, 626*4, 1650*4, 370*4, 1394*4, 882*4, 1906*4, 242*4, 1266*4, 754*4, 1778*4, 498*4, 1522*4, 1010*4, 2034*4
	.dc.w	10*4, 1034*4, 522*4, 1546*4, 266*4, 1290*4, 778*4, 1802*4, 138*4, 1162*4, 650*4, 1674*4, 394*4, 1418*4, 906*4, 1930*4
	.dc.w	74*4, 1098*4, 586*4, 1610*4, 330*4, 1354*4, 842*4, 1866*4, 202*4, 1226*4, 714*4, 1738*4, 458*4, 1482*4, 970*4, 1994*4
	.dc.w	42*4, 1066*4, 554*4, 1578*4, 298*4, 1322*4, 810*4, 1834*4, 170*4, 1194*4, 682*4, 1706*4, 426*4, 1450*4, 938*4, 1962*4
	.dc.w	106*4, 1130*4, 618*4, 1642*4, 362*4, 1386*4, 874*4, 1898*4, 234*4, 1258*4, 746*4, 1770*4, 490*4, 1514*4, 1002*4, 2026*4
	.dc.w	26*4, 1050*4, 538*4, 1562*4, 282*4, 1306*4, 794*4, 1818*4, 154*4, 1178*4, 666*4, 1690*4, 410*4, 1434*4, 922*4, 1946*4
	.dc.w	90*4, 1114*4, 602*4, 1626*4, 346*4, 1370*4, 858*4, 1882*4, 218*4, 1242*4, 730*4, 1754*4, 474*4, 1498*4, 986*4, 2010*4
	.dc.w	58*4, 1082*4, 570*4, 1594*4, 314*4, 1338*4, 826*4, 1850*4, 186*4, 1210*4, 698*4, 1722*4, 442*4, 1466*4, 954*4, 1978*4
	.dc.w	122*4, 1146*4, 634*4, 1658*4, 378*4, 1402*4, 890*4, 1914*4, 250*4, 1274*4, 762*4, 1786*4, 506*4, 1530*4, 1018*4, 2042*4
	.dc.w	6*4, 1030*4, 518*4, 1542*4, 262*4, 1286*4, 774*4, 1798*4, 134*4, 1158*4, 646*4, 1670*4, 390*4, 1414*4, 902*4, 1926*4
	.dc.w	70*4, 1094*4, 582*4, 1606*4, 326*4, 1350*4, 838*4, 1862*4, 198*4, 1222*4, 710*4, 1734*4, 454*4, 1478*4, 966*4, 1990*4
	.dc.w	38*4, 1062*4, 550*4, 1574*4, 294*4, 1318*4, 806*4, 1830*4, 166*4, 1190*4, 678*4, 1702*4, 422*4, 1446*4, 934*4, 1958*4
	.dc.w	102*4, 1126*4, 614*4, 1638*4, 358*4, 1382*4, 870*4, 1894*4, 230*4, 1254*4, 742*4, 1766*4, 486*4, 1510*4, 998*4, 2022*4
	.dc.w	22*4, 1046*4, 534*4, 1558*4, 278*4, 1302*4, 790*4, 1814*4, 150*4, 1174*4, 662*4, 1686*4, 406*4, 1430*4, 918*4, 1942*4 
	.dc.w	86*4, 1110*4, 598*4, 1622*4, 342*4, 1366*4, 854*4, 1878*4, 214*4, 1238*4, 726*4, 1750*4, 470*4, 1494*4, 982*4, 2006*4 
	.dc.w	54*4, 1078*4, 566*4, 1590*4, 310*4, 1334*4, 822*4, 1846*4, 182*4, 1206*4, 694*4, 1718*4, 438*4, 1462*4, 950*4, 1974*4 
	.dc.w	118*4, 1142*4, 630*4, 1654*4, 374*4, 1398*4, 886*4, 1910*4, 246*4, 1270*4, 758*4, 1782*4, 502*4, 1526*4, 1014*4, 2038*4
	.dc.w	14*4, 1038*4, 526*4, 1550*4, 270*4, 1294*4, 782*4, 1806*4, 142*4, 1166*4, 654*4, 1678*4, 398*4, 1422*4, 910*4, 1934*4
	.dc.w	78*4, 1102*4, 590*4, 1614*4, 334*4, 1358*4, 846*4, 1870*4, 206*4, 1230*4, 718*4, 1742*4, 462*4, 1486*4, 974*4, 1998*4
	.dc.w	46*4, 1070*4, 558*4, 1582*4, 302*4, 1326*4, 814*4, 1838*4, 174*4, 1198*4, 686*4, 1710*4, 430*4, 1454*4, 942*4, 1966*4
	.dc.w	110*4, 1134*4, 622*4, 1646*4, 366*4, 1390*4, 878*4, 1902*4, 238*4, 1262*4, 750*4, 1774*4, 494*4, 1518*4, 1006*4, 2030*4
	.dc.w	30*4, 1054*4, 542*4, 1566*4, 286*4, 1310*4, 798*4, 1822*4, 158*4, 1182*4, 670*4, 1694*4, 414*4, 1438*4, 926*4, 1950*4 
	.dc.w	94*4, 1118*4, 606*4, 1630*4, 350*4, 1374*4, 862*4, 1886*4, 222*4, 1246*4, 734*4, 1758*4, 478*4, 1502*4, 990*4, 2014*4 
	.dc.w	62*4, 1086*4, 574*4, 1598*4, 318*4, 1342*4, 830*4, 1854*4, 190*4, 1214*4, 702*4, 1726*4, 446*4, 1470*4, 958*4, 1982*4 
	.dc.w	126*4, 1150*4, 638*4, 1662*4, 382*4, 1406*4, 894*4, 1918*4, 254*4, 1278*4, 766*4, 1790*4, 510*4, 1534*4, 1022*4, 2046*4

#elif FFT_N == 512
#ifdef INPUT_IQ
	.dc.w	1*4, 257*4, 129*4, 385*4, 65*4, 321*4, 193*4, 449*4, 33*4, 289*4, 161*4, 417*4, 97*4, 353*4, 225*4, 481*4
	.dc.w	17*4, 273*4, 145*4, 401*4, 81*4, 337*4, 209*4, 465*4, 49*4, 305*4, 177*4, 433*4, 113*4, 369*4, 241*4, 497*4
	.dc.w	9*4, 265*4, 137*4, 393*4, 73*4, 329*4, 201*4, 457*4, 41*4, 297*4, 169*4, 425*4, 105*4, 361*4, 233*4, 489*4
	.dc.w	25*4, 281*4, 153*4, 409*4, 89*4, 345*4, 217*4, 473*4, 57*4, 313*4, 185*4, 441*4, 121*4, 377*4, 249*4, 505*4
	.dc.w	5*4, 261*4, 133*4, 389*4, 69*4, 325*4, 197*4, 453*4, 37*4, 293*4, 165*4, 421*4, 101*4, 357*4, 229*4, 485*4
	.dc.w	21*4, 277*4, 149*4, 405*4, 85*4, 341*4, 213*4, 469*4, 53*4, 309*4, 181*4, 437*4, 117*4, 373*4, 245*4, 501*4
	.dc.w	13*4, 269*4, 141*4, 397*4, 77*4, 333*4, 205*4, 461*4, 45*4, 301*4, 173*4, 429*4, 109*4, 365*4, 237*4, 493*4
	.dc.w	29*4, 285*4, 157*4, 413*4, 93*4, 349*4, 221*4, 477*4, 61*4, 317*4, 189*4, 445*4, 125*4, 381*4, 253*4, 509*4
	.dc.w	3*4, 259*4, 131*4, 387*4, 67*4, 323*4, 195*4, 451*4, 35*4, 291*4, 163*4, 419*4, 99*4, 355*4, 227*4, 483*4
	.dc.w	19*4, 275*4, 147*4, 403*4, 83*4, 339*4, 211*4, 467*4, 51*4, 307*4, 179*4, 435*4, 115*4, 371*4, 243*4, 499*4
	.dc.w	11*4, 267*4, 139*4, 395*4, 75*4, 331*4, 203*4, 459*4, 43*4, 299*4, 171*4, 427*4, 107*4, 363*4, 235*4, 491*4
	.dc.w	27*4, 283*4, 155*4, 411*4, 91*4, 347*4, 219*4, 475*4, 59*4, 315*4, 187*4, 443*4, 123*4, 379*4, 251*4, 507*4
	.dc.w	7*4, 263*4, 135*4, 391*4, 71*4, 327*4, 199*4, 455*4, 39*4, 295*4, 167*4, 423*4, 103*4, 359*4, 231*4, 487*4
	.dc.w	23*4, 279*4, 151*4, 407*4, 87*4, 343*4, 215*4, 471*4, 55*4, 311*4, 183*4, 439*4, 119*4, 375*4, 247*4, 503*4
	.dc.w	15*4, 271*4, 143*4, 399*4, 79*4, 335*4, 207*4, 463*4, 47*4, 303*4, 175*4, 431*4, 111*4, 367*4, 239*4, 495*4
	.dc.w	31*4, 287*4, 159*4, 415*4, 95*4, 351*4, 223*4, 479*4, 63*4, 319*4, 191*4, 447*4, 127*4, 383*4, 255*4, 511*4
#endif
	.dc.w	0*4, 256*4, 128*4, 384*4, 64*4, 320*4, 192*4, 448*4, 32*4, 288*4, 160*4, 416*4, 96*4, 352*4, 224*4, 480*4
	.dc.w	16*4, 272*4, 144*4, 400*4, 80*4, 336*4, 208*4, 464*4, 48*4, 304*4, 176*4, 432*4, 112*4, 368*4, 240*4, 496*4
	.dc.w	8*4, 264*4, 136*4, 392*4, 72*4, 328*4, 200*4, 456*4, 40*4, 296*4, 168*4, 424*4, 104*4, 360*4, 232*4, 488*4
	.dc.w	24*4, 280*4, 152*4, 408*4, 88*4, 344*4, 216*4, 472*4, 56*4, 312*4, 184*4, 440*4, 120*4, 376*4, 248*4, 504*4
	.dc.w	4*4, 260*4, 132*4, 388*4, 68*4, 324*4, 196*4, 452*4, 36*4, 292*4, 164*4, 420*4, 100*4, 356*4, 228*4, 484*4
	.dc.w	20*4, 276*4, 148*4, 404*4, 84*4, 340*4, 212*4, 468*4, 52*4, 308*4, 180*4, 436*4, 116*4, 372*4, 244*4, 500*4
	.dc.w	12*4, 268*4, 140*4, 396*4, 76*4, 332*4, 204*4, 460*4, 44*4, 300*4, 172*4, 428*4, 108*4, 364*4, 236*4, 492*4
	.dc.w	28*4, 284*4, 156*4, 412*4, 92*4, 348*4, 220*4, 476*4, 60*4, 316*4, 188*4, 444*4, 124*4, 380*4, 252*4, 508*4
	.dc.w	2*4, 258*4, 130*4, 386*4, 66*4, 322*4, 194*4, 450*4, 34*4, 290*4, 162*4, 418*4, 98*4, 354*4, 226*4, 482*4
	.dc.w	18*4, 274*4, 146*4, 402*4, 82*4, 338*4, 210*4, 466*4, 50*4, 306*4, 178*4, 434*4, 114*4, 370*4, 242*4, 498*4
	.dc.w	10*4, 266*4, 138*4, 394*4, 74*4, 330*4, 202*4, 458*4, 42*4, 298*4, 170*4, 426*4, 106*4, 362*4, 234*4, 490*4
	.dc.w	26*4, 282*4, 154*4, 410*4, 90*4, 346*4, 218*4, 474*4, 58*4, 314*4, 186*4, 442*4, 122*4, 378*4, 250*4, 506*4
	.dc.w	6*4, 262*4, 134*4, 390*4, 70*4, 326*4, 198*4, 454*4, 38*4, 294*4, 166*4, 422*4, 102*4, 358*4, 230*4, 486*4
	.dc.w	22*4, 278*4, 150*4, 406*4, 86*4, 342*4, 214*4, 470*4, 54*4, 310*4, 182*4, 438*4, 118*4, 374*4, 246*4, 502*4
	.dc.w	14*4, 270*4, 142*4, 398*4, 78*4, 334*4, 206*4, 462*4, 46*4, 302*4, 174*4, 430*4, 110*4, 366*4, 238*4, 494*4
	.dc.w	30*4, 286*4, 158*4, 414*4, 94*4, 350*4, 222*4, 478*4, 62*4, 318*4, 190*4, 446*4, 126*4, 382*4, 254*4, 510*4

#elif FFT_N == 256
#ifdef INPUT_IQ
	.dc.w	1*4, 129*4, 65*4, 193*4, 33*4, 161*4, 97*4, 225*4, 17*4, 145*4, 81*4, 209*4, 49*4, 177*4, 113*4, 241*4
	.dc.w	9*4, 137*4, 73*4, 201*4, 41*4, 169*4, 105*4, 233*4, 25*4, 153*4, 89*4, 217*4, 57*4, 185*4, 121*4, 249*4
	.dc.w	5*4, 133*4, 69*4, 197*4, 37*4, 165*4, 101*4, 229*4, 21*4, 149*4, 85*4, 213*4, 53*4, 181*4, 117*4, 245*4
	.dc.w	13*4, 141*4, 77*4, 205*4, 45*4, 173*4, 109*4, 237*4, 29*4, 157*4, 93*4, 221*4, 61*4, 189*4, 125*4, 253*4
	.dc.w	3*4, 131*4, 67*4, 195*4, 35*4, 163*4, 99*4, 227*4, 19*4, 147*4, 83*4, 211*4, 51*4, 179*4, 115*4, 243*4
	.dc.w	11*4, 139*4, 75*4, 203*4, 43*4, 171*4, 107*4, 235*4, 27*4, 155*4, 91*4, 219*4, 59*4, 187*4, 123*4, 251*4
	.dc.w	7*4, 135*4, 71*4, 199*4, 39*4, 167*4, 103*4, 231*4, 23*4, 151*4, 87*4, 215*4, 55*4, 183*4, 119*4, 247*4
	.dc.w	15*4, 143*4, 79*4, 207*4, 47*4, 175*4, 111*4, 239*4, 31*4, 159*4, 95*4, 223*4, 63*4, 191*4, 127*4, 255*4
#endif
	.dc.w	0*4, 128*4, 64*4, 192*4, 32*4, 160*4, 96*4, 224*4, 16*4, 144*4, 80*4, 208*4, 48*4, 176*4, 112*4, 240*4
	.dc.w	8*4, 136*4, 72*4, 200*4, 40*4, 168*4, 104*4, 232*4, 24*4, 152*4, 88*4, 216*4, 56*4, 184*4, 120*4, 248*4
	.dc.w	4*4, 132*4, 68*4, 196*4, 36*4, 164*4, 100*4, 228*4, 20*4, 148*4, 84*4, 212*4, 52*4, 180*4, 116*4, 244*4
	.dc.w	12*4, 140*4, 76*4, 204*4, 44*4, 172*4, 108*4, 236*4, 28*4, 156*4, 92*4, 220*4, 60*4, 188*4, 124*4, 252*4
	.dc.w	2*4, 130*4, 66*4, 194*4, 34*4, 162*4, 98*4, 226*4, 18*4, 146*4, 82*4, 210*4, 50*4, 178*4, 114*4, 242*4
	.dc.w	10*4, 138*4, 74*4, 202*4, 42*4, 170*4, 106*4, 234*4, 26*4, 154*4, 90*4, 218*4, 58*4, 186*4, 122*4, 250*4
	.dc.w	6*4, 134*4, 70*4, 198*4, 38*4, 166*4, 102*4, 230*4, 22*4, 150*4, 86*4, 214*4, 54*4, 182*4, 118*4, 246*4
	.dc.w	14*4, 142*4, 78*4, 206*4, 46*4, 174*4, 110*4, 238*4, 30*4, 158*4, 94*4, 222*4, 62*4, 190*4, 126*4, 254*4

#elif FFT_N == 128
#ifdef INPUT_IQ
	.dc.w	1*4, 65*4, 33*4, 97*4, 17*4, 81*4, 49*4, 113*4, 9*4, 73*4, 41*4, 105*4, 25*4, 89*4, 57*4, 121*4
	.dc.w	5*4, 69*4, 37*4, 101*4, 21*4, 85*4, 53*4, 117*4, 13*4, 77*4, 45*4, 109*4, 29*4, 93*4, 61*4, 125*4
	.dc.w	3*4, 67*4, 35*4, 99*4, 19*4, 83*4, 51*4, 115*4, 11*4, 75*4, 43*4, 107*4, 27*4, 91*4, 59*4, 123*4
	.dc.w	7*4, 71*4, 39*4, 103*4, 23*4, 87*4, 55*4, 119*4, 15*4, 79*4, 47*4, 111*4, 31*4, 95*4, 63*4, 127*4
#endif
	.dc.w	0*4, 64*4, 32*4, 96*4, 16*4, 80*4, 48*4, 112*4, 8*4, 72*4, 40*4, 104*4, 24*4, 88*4, 56*4, 120*4
	.dc.w	4*4, 68*4, 36*4, 100*4, 20*4, 84*4, 52*4, 116*4, 12*4, 76*4, 44*4, 108*4, 28*4, 92*4, 60*4, 124*4
	.dc.w	2*4, 66*4, 34*4, 98*4, 18*4, 82*4, 50*4, 114*4, 10*4, 74*4, 42*4, 106*4, 26*4, 90*4, 58*4, 122*4
	.dc.w	6*4, 70*4, 38*4, 102*4, 22*4, 86*4, 54*4, 118*4, 14*4, 78*4, 46*4, 110*4, 30*4, 94*4, 62*4, 126*4

#elif FFT_N == 64
#ifdef INPUT_IQ
	.dc.w	1*4, 33*4, 17*4, 49*4, 9*4, 41*4, 25*4, 57*4, 5*4, 37*4, 21*4, 53*4, 13*4, 45*4, 29*4, 61*4
	.dc.w	3*4, 35*4, 19*4, 51*4, 11*4, 43*4, 27*4, 59*4, 7*4, 39*4, 23*4, 55*4, 15*4, 47*4, 31*4, 63*4
#endif
	.dc.w	0*4, 32*4, 16*4, 48*4, 8*4, 40*4, 24*4, 56*4, 4*4, 36*4, 20*4, 52*4, 12*4, 44*4, 28*4, 60*4
	.dc.w	2*4, 34*4, 18*4, 50*4, 10*4, 42*4, 26*4, 58*4, 6*4, 38*4, 22*4, 54*4, 14*4, 46*4, 30*4, 62*4
#endif



;----------------------------------------------------------------------------;
#ifndef INPUT_NOUSE
.global fft_input
.func fft_input
fft_input:
	pushw	T2H,T2L
	pushw	AH,AL
	pushw	YH,YL

	movw	XL, EL						;X = array_src;
	movw	YL, DL						;Y = array_bfly;
	clr	EH								;Zero
	ldiw	ZH,ZL, tbl_window			;Z = &tbl_window[0];
	ldiw	AH,AL, FFT_N				;A = FFT_N;
1:	lpmw	BH,BL, Z+					;B = *Z++; (window)
	ldw	CH,CL, X+						;C = *X++; (I-axis)
	FMULS16	DH,DL,T2H,T2L, BH,BL, CH,CL	;D = B * C;
	stw	Y+, DH,DL						;*Y++ = D;
#ifdef INPUT_IQ
	ldw	CH,CL, X+						;C = *X++; (Q-axis)
	FMULS16	DH,DL,T2H,T2L, BH,BL, CH,CL	;D = B * C;
#endif
	stw	Y+, DH,DL						;*Y++ = D;
	subiw	AH,AL, 1					;while(--A)
	brne	1b							;/

	popw	YH,YL
	popw	AH,AL
	popw	T2H,T2L
	clr	r1
	ret
.endfunc
#endif	/* INPUT_NOUSE */



;----------------------------------------------------------------------------;
.global fft_execute
.func fft_execute
fft_execute:
	pushw	T2H,T2L
	pushw	T4H,T4L
	pushw	T6H,T6L
	pushw	T8H,T8L
	pushw	T10H,T10L
	pushw	T12H,T12L
	pushw	T14H,T14L
	pushw	AH,AL
	pushw	YH,YL

	movw	ZL, EL				;Z = array_bfly;
	ldiw	EH,EL, 1			;E = 1;
	ldiw	XH,XL, FFT_N/2		;X = FFT_N/2;
1:	ldi	AL, 4					;T12 = E; (angular speed)
	mul	EL, AL					;
	movw	T12L, T0L			;
	mul	EH, AL					;
	add	T12H, T0L				;/
	movw	T14L, EL			;T14 = E;
	pushw	EH,EL
	movw	YL, ZL				;Z = &array_bfly[0];
	mul	XL, AL					;Y = &array_bfly[X];
	addw	YH,YL, T0H,T0L			;
	mul	XH, AL					;
	add	YH, T0L					;/
	pushw	ZH,ZL
2:	clrw	T10H,T10L			;T10 = 0 (angle)
	clr	EH				;Zero reg.
3:	lddw	AH,AL, Z+0			;A = *Z - *Y; *Z++ += *Y;
	asrw	AH,AL				;
	lddw	DH,DL, Y+0			;
	asrw	DH,DL				;
	movw	CL, AL				;
	subw	AH,AL, DH,DL			;
	addw	CH,CL, DH,DL			;
	stw	Z+, CH,CL			;/
	lddw	BH,BL, Z+0			;B = *Z - *Y; *Z++ += *Y;
	asrw	BH,BL				;
	lddw	DH,DL, Y+2			;
	asrw	DH,DL				;
	movw	CL, BL				;
	subw	BH,BL, DH,DL			;
	addw	CH,CL, DH,DL			;
	stw	Z+, CH,CL			;/
	movw	T0L, ZL
	ldiw	ZH,ZL, tbl_cos_sin		;C = cos(T10); D = sin(T10);
	addw	ZH,ZL, T10H,T10L		;
	lpmw	CH,CL, Z+			;
	lpmw	DH,DL, Z+			;/
	movw	ZL, T0L
	FMULS16	T4H,T4L,T2H,T2L, AH,AL, CH,CL	;*Y++ = A * C + B * D;
	FMULS16	T8H,T8L,T6H,T6L, BH,BL, DH,DL	;
	addd	T4H,T4L,T2H,T2L, T8H,T8L,T6H,T6L;
	stw	Y+, T4H,T4L			;/
	FMULS16	T4H,T4L,T2H,T2L, BH,BL, CH,CL 	;*Y++ = B * C - A * D;
	FMULS16	T8H,T8L,T6H,T6L, AH,AL, DH,DL 	;
	subd	T4H,T4L,T2H,T2L, T8H,T8L,T6H,T6L;
	stw	Y+, T4H,T4L			;/
	addw	T10H,T10L, T12H,T12L		;T10 += T12; (next angle)
#if FFT_N >= 128
	sbrs	T10H, FFT_B - 7			;while(T10 < pi)
#else
	sbrs	T10L, FFT_B + 1
#endif
	rjmp	3b				;/
	ldi	AL, 4				;Y += X; Z += X; (skip split segment)
	mul	XL, AL
	addw	YH,YL, T0H,T0L			;
	addw	ZH,ZL, T0H,T0L			;
	mul	XH, AL				;
	add	YH, T0L				;
	add	ZH, T0L				;/
	ldi	EL, 1				;while(--T14)
	subw	T14H,T14L, EH,EL		;
	rjne	2b				;/
	popw	ZH,ZL
	popw	EH,EL
	lslw	EH,EL				;E *= 2;
	lsrw	XH,XL				;while(X /= 2)
	adiw	XL, 0				;
	rjne	1b				;/

	popw	YH,YL
	popw	AH,AL
	popw	T14H,T14L
	popw	T12H,T12L
	popw	T10H,T10L
	popw	T8H,T8L
	popw	T6H,T6L
	popw	T4H,T4L
	popw	T2H,T2L
;	clr	r1
	ret
.endfunc



;----------------------------------------------------------------------------;
.global fft_output
.func fft_output
fft_output:
	pushw	T2H,T2L
	pushw	T4H,T4L
	pushw	T6H,T6L
	pushw	T8H,T8L
	pushw	T10H,T10L
	pushw	AH,AL
	pushw	YH,YL

	movw	T10L, EL			;T10 = array_bfly;
	movw	YL, DL				;Y = array_output;
	ldiw	ZH,ZL, tbl_bitrev		;Z = tbl_bitrev;
	clr	EH				;Zero
#ifdef INPUT_IQ
	ldiw	AH,AL, FFT_N			;A = FFT_N; (pluse/minus)
#else
	ldiw	AH,AL, FFT_N / 2		;A = FFT_N / 2; (pluse only)
#endif
1:	lpmw	XH,XL, Z+			;X = *Z++;
	addw	XH,XL, T10H,T10L		;X += array_bfly;
	ldw	BH,BL, X+			;B = *X++;
	ldw	CH,CL, X+			;C = *X++;
	FMULS16	T4H,T4L,T2H,T2L, BH,BL, BH,BL	;T4:T2 = B * B;
	FMULS16	T8H,T8L,T6H,T6L, CH,CL, CH,CL	;T8:T6 = C * C;
	addd	T4H,T4L,T2H,T2L, T8H,T8L,T6H,T6L;T4:T2 += T8:T6;
	SQRT32					;B = sqrt(T4:T2);
	stw	Y+, BH,BL			;*Y++ = B;
	subiw	AH,AL, 1			;while(--A)
	rjne	1b				;/

	popw	YH,YL
	popw	AH,AL
	popw	T10H,T10L
	popw	T8H,T8L
	popw	T6H,T6L
	popw	T4H,T4L
	popw	T2H,T2L
	clr	r1
	ret
.endfunc



;----------------------------------------------------------------------------;
.global fmuls_f
.func fmuls_f
fmuls_f:
	movw	CL, EL				;C = E;
	clr	EH	;Zero
	FMULS16	ZH,ZL,XH,XL, CH,CL, DH,DL	;Z:X = C * D;
	movw	EL, ZL
	clr	r1
	ret
.endfunc

